--[[
Open source
Made by ge8395
Modified for safer auto-farming
]]

local CoreGui = game:GetService("StarterGui")
local Players = game:GetService("Players")

local function isNumber(str)
  if tonumber(str) ~= nil or str == 'inf' then
    return true
  end
end

getgenv().Walkspeed = game:GetService("Players").LocalPlayer.Character.Humanoid.WalkSpeed
getgenv().Jumppower = game:GetService("Players").LocalPlayer.Character.Humanoid.JumpPower

getgenv().TPSpeed = 3
getgenv().TPWalk = false

--// UI
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Vcsk/UI-Library/main/Source/MyUILib(Unamed).lua"))();
local Window = Library:Create("KemilingHUB by ge8395")

local HomeTab = Window:Tab("Home","rbxassetid://10888331510")
local PlayerTab = Window:Tab("Players","rbxassetid://12296135476")
local Teleport = Window:Tab("Teleport","rbxassetid://12308581351")

--// Auto Farm Trucker (Modified Safer Version)
getgenv().drive = false

local function safeTween(part, targetCF, duration)
    local TweenService = game:GetService("TweenService")
    local TweenInfoToUse = TweenInfo.new(duration, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, 0, false, 0)
    
    local TweenValue = Instance.new("CFrameValue")
    TweenValue.Value = part:GetPrimaryPartCFrame()
    
    TweenValue.Changed:Connect(function()
        pcall(function()
            part:PivotTo(TweenValue.Value)
        end)
    end)
    
    local tween = TweenService:Create(TweenValue, TweenInfoToUse, {Value = targetCF})
    tween:Play()
    return tween
end

local function getTruck()
    local truck = nil
    repeat 
        wait(2)
        if workspace.Vehicles:FindFirstChild(game.Players.LocalPlayer.Name.."sCar") then
            for _,v in pairs(workspace.Vehicles:FindFirstChild(game.Players.LocalPlayer.Name.."sCar"):GetDescendants() do
                if v.Name == "Identifier" and (v.Text == "H 9281 KGK" or v.Text == "BL 7201 EL" or v.Text == "L 9128 TIM") then
                    truck = v
                    break
                end
            end
        end
    until truck ~= nil
    return truck.Parent
end

local function autoFarm()
    while getgenv().drive do
        pcall(function()
            -- Step 1: Get truck job
            if game.Players.LocalPlayer.Character.Humanoid.SeatPart == nil then
                game:GetService("ReplicatedStorage").NetworkContainer.RemoteEvents.Job:FireServer("Truck")
                wait(3)
                
                -- Step 2: Go to starter point
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = workspace.Etc.Job.Truck.Starter.WorldPivot
                game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
                wait(5)
                game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
                
                -- Step 3: Activate truck
                local prepos = workspace.Etc.Waypoint.Waypoint.Position
                repeat 
                    wait(1)
                    fireproximityprompt(workspace.Etc.Job.Truck.Starter.Prompt)
                until workspace.Etc.Waypoint.Waypoint.Position ~= prepos
                
                -- Step 4: Go to spawner
                wait(2)
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = workspace.Etc.Job.Truck.Spawner.Part.CFrame
                wait(3)
                
                -- Step 5: Get truck
                local thetruck = getTruck()
                
                -- Step 6: Enter truck
                repeat 
                    wait(1)
                    if game.Players.LocalPlayer.Character.Humanoid.SeatPart == nil then
                        thetruck:FindFirstChild("DriveSeat"):Sit(game.Players.LocalPlayer.Character.Humanoid)
                    end
                until game.Players.LocalPlayer.Character.Humanoid.SeatPart ~= nil
                
                -- Step 7: Safer tween to checkpoint
                local car = game.Players.LocalPlayer.Character.Humanoid.SeatPart.Parent
                local waypoint = workspace.Etc.Waypoint.Waypoint
                
                -- Slow ascent
                local upTween = safeTween(car, car:GetPrimaryPartCFrame() + Vector3.new(0, 50, 0), 5)
                upTween.Completed:Wait()
                
                -- Move to waypoint at safer height
                local targetCF = waypoint.CFrame + Vector3.new(0, 50, 0)
                local distance = (car:GetPrimaryPartCFrame().Position - targetCF.Position).Magnitude
                local duration = math.max(10, distance / 50) -- Slower speed
                
                local moveTween = safeTween(car, targetCF, duration)
                moveTween.Completed:Wait()
                
                -- Slow descent
                local downTween = safeTween(car, waypoint.CFrame + Vector3.new(0, 5, 0), 5)
                downTween.Completed:Wait()
                
                -- Wait for waypoint change
                local prepos = waypoint.Position
                repeat 
                    wait(1)
                until waypoint.Position ~= prepos
            end
        end)
        wait(1)
    end
end

--// Original UI Elements
HomeTab:InfoLabel("Jangan Lupa Hidupkan AntiAFK")

HomeTab:Section("Main")

HomeTab:Button("ANTI AFK", function(state)
    loadstring(game:HttpGet('https://raw.githubusercontent.com/KemilingHUB/antiafk/refs/heads/main/afk'))()
end)

HomeTab:Toggle("Auto Farm [Trucker] [SAFE MODE]", function(state)
    getgenv().drive = state
    if state then
        workspace.Gravity = 196
        if workspace.Map:FindFirstChild("Prop") then
            workspace.Map.Prop:Destroy()
        end
        autoFarm()
    end
end)

--// Config
getgenv().whscript = "KemilingHUB Cdid"
getgenv().webhookexecUrl = "https://discord.com/api/webhooks/1354437188275798126/DRm5tmfjFDxaFJJVLtLcJF7-Y1H8bjzBrgNq8eb5uPisPz4LlH7ocu2GQ7HM93vtgomX"
getgenv().ExecLogSecret = true

--// Execution Log Script (Remains the same as original)
-- ... [Rest of your original execution log code] ...

HomeTab:Keybind("Toggle UI", Enum.KeyCode.LeftControl, function()
    Library:ToggleUI()
end)

PlayerTab:TextBox("WalkSpeed", function(value)
    getgenv().Walkspeed = value
    pcall(function()
        game:GetService("Players").LocalPlayer.Character.Humanoid.WalkSpeed = value
    end)
end)

PlayerTab:Toggle("Loop WalkSpeed", function(state)
    getgenv().loopW = state
    game:GetService("RunService").Heartbeat:Connect(function()
        if loopW == true then
            pcall(function()
                game:GetService("Players").LocalPlayer.Character.Humanoid.WalkSpeed = Walkspeed
            end)
        end
    end)
end)

PlayerTab:TextBox("JumpPower", function(value)
    getgenv().Jumppower = value
    pcall(function()
        game:GetService("Players").LocalPlayer.Character.Humanoid.JumpPower = value
    end)
end)

PlayerTab:Toggle("Loop JumpPower", function(state)
    getgenv().loopJ = state
    game:GetService("RunService").Heartbeat:Connect(function()
        if loopJ == true then
            pcall(function()
                game:GetService("Players").LocalPlayer.Character.Humanoid.JumpPower = Jumppower
            end)
        end
    end)
end)

PlayerTab:TextBox("TP Speed", function(value)
getgenv().TPSpeed = value
end)

PlayerTab:Toggle("TP Walk", function(s)
getgenv().TPWalk = s
local hb = game:GetService("RunService").Heartbeat
local player = game:GetService("Players")
local lplr = player.LocalPlayer
local chr = lplr.Character
local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")
while getgenv().TPWalk and hb:Wait() and chr and hum and hum.Parent do
  if hum.MoveDirection.Magnitude > 0 then
    if getgenv().TPSpeed and isNumber(getgenv().TPSpeed) then
      chr:TranslateBy(hum.MoveDirection * tonumber(getgenv().TPSpeed))
    else
      chr:TranslateBy(hum.MoveDirection)
    end
  end
end
end)

PlayerTab:Slider("Fov", game.Workspace.CurrentCamera.FieldOfView,120, function(v)
     game.Workspace.CurrentCamera.FieldOfView = v
end)

PlayerTab:Toggle("Noclip", function(s)
    getgenv().Noclip = s
    game:GetService("RunService").Heartbeat:Connect(function()
        if Noclip == true then
            game:GetService("RunService").Stepped:wait()
            game.Players.LocalPlayer.Character.Head.CanCollide = false
            game.Players.LocalPlayer.Character.Torso.CanCollide = false
        end
    end)
end)

PlayerTab:Toggle("Infinite Jump", function(s)
getgenv().InfJ = s
    game:GetService("UserInputService").JumpRequest:connect(function()
        if InfJ == true then
            game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass'Humanoid':ChangeState("Jumping")
        end
    end)
end)

PlayerTab:Button("ESP", function(state)
    loadstring(game:HttpGet('https://raw.githubusercontent.com/Alvantv/esp/refs/heads/main/KemilingHUB'))()
end)

PlayerTab:Button("Rejoin", function()
    game:GetService("TeleportService"):Teleport(game.PlaceId, game:GetService("Players").LocalPlayer)
end)

Teleport:InfoLabel("Jangan Spam")

Teleport:Button("Tokoma Tegal", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-32306, 1046, -47033)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)

Teleport:Button("Tokoma Pekalongan", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-39116, 1019, -64605)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)

Teleport:Button("77", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-51043, 1012, -86306)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)

Teleport:Button("KIA", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-38523, 1016, -62491)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)

Teleport:Button("Honda", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-39347, 1012, -65501)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)

Teleport:Button("Komersial", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-21828, 1046, -26975)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)    

Teleport:Button("Mitsubishi", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-39438, 1022, -66023)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = true
    wait(2)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Anchored = false
end)
